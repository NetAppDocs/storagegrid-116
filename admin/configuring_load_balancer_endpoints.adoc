---
permalink: admin/configuring_load_balancer_endpoints.html
sidebar: sidebar
keywords: load balancer endpoint, endpoint, S3 client connection, Swift client connection
summary: 'Load balancer endpoints determine the ports and network protocols S3 and Swift clients can use when connecting to the StorageGRID load balancer on Gateway and Admin Nodes. '
---
= Configuring load balancer endpoints
:icons: font
:imagesdir: ../media/

[.lead]
Load balancer endpoints determine the ports and network protocols S3 and Swift clients can use when connecting to the StorageGRID load balancer on Gateway and Admin Nodes.

.What you'll need

* You are signed in to the Grid Manager using a supported browser.
* You have the Root Access permission.
* If you previously remapped a port you intend to use for the load balancer endpoint, you have xref:..maintain/removing_port_remaps..adoc[removed the port remap].
+
IMPORTANT: If you have remapped any ports, you cannot use the same ports to configure load balancer endpoints. You can create endpoints using remapped ports, but those endpoints will be remapped to ports used by the deprecated CLB service, not the Load Balancer service.

*  You have created any high availability (HA) groups you plan to use. See xref:managing_high_availability_groups.adoc[Managing high availability groups].

* If you are creating an HTTPS endpoint (recommended), you have the information required to upload or generate the server certificate.

== Creating load balancer endpoints

Each load balancer endpoint specifies a port, a network protocol (HTTP or HTTPS), and a service type (S3 or Swift).


.About this task
After you create the endpoint, provide clients with the port number, the virtual IP of the HA group (or the IP address of a Gateway or Admin Node), and any required certificate details.



.Steps

. Select *CONFIGURATION* > *Network* > *Load balancer endpoints*.

. Select *Create*.
+
image::../media/load_balancer_endpoint_create_http.png[Create LB Endpoint]

. Enter the following endpoint details:
+
[cols="1a,2a" options="header"]
|===
| Field| Description

|Name
|A descriptive name for the endpoint, which will appear in the table on the Load balancer endpoints page.

|Port
|The port clients will use to connect to the load balancer on Admin Nodes and Gateway Nodes.

Accept the suggested port number or enter any external port that is not used by another grid service.

If you enter *80* or *443*, the endpoint is configured only on Gateway Nodes. These ports are reserved on Admin Nodes.

xref:../network/index.adoc[Network guidelines]

|Client type
|The type of client application that will use this endpoint, either *S3* or *Swift*.

|Network protocol
|The network protocol that clients will use when connecting to this endpoint.

*  Select *HTTPS* for secure, TLS encrypted communication. You must attach a security certificate before you can save the endpoint.

* Select *HTTP* for less secure, unencrypted communication. Use HTTP only for a non-production grid.
|===

. Select *Continue* to select the binding mode for the endpoint.
+
The binding mode controls how the endpoint is accessed--using any IP address or using specific IP addresses and network interfaces.
+
[cols="1a,2a" options="header"]
|===
| Field| Description

|Global (default)
|Clients can access the endpoint using the IP address of any Gateway Node or Admin Node, or the virtual IP address of any HA group on any network.

Use the *Global* setting (default) unless you need to restrict the accessibility of this endpoint.

|Virtual IPs of HA groups
|Clients can only access the endpoint using a virtual IP address of an HA group.

Endpoints using this mode can all use the same port number, as long as the HA groups you select for the endpoints do not overlap.

|Node interfaces
|Clients can only access the endpoint using the IP address of a selected node and network interface.

Endpoints using this mode can all use the same port number as long as the interfaces you select for the endpoints do not overlap.

|===
+
[NOTE]
If you use the same port for more than one endpoint, you must use a different binding mode for each endpoint. The *Virtual IPs of HA groups* mode overrides the *Node interfaces* mode, which overrides the *Global* mode.

* If you selected *Virtual IPs of HA groups*, select the HA groups.
+
image::../media/load_balancer_endpoint_ha_group_vips_binding_mode.png[Endpoint HA Group VIPs Binding Mode]
+
* If you selected *Node interfaces*, select one or more node interfaces for each Admin Node or Gateway Node you want to associate with this endpoint.
+
image::../media/load_balancer_endpoint_node_interfaces_binding_mode.png[Endpoint Node Interfaces Binding Mode]

. Select *Create* to create an *HTTP* endpoint, or select *Continue* to attach a certificate to an *HTTPS* endpoint.

. Select the type of security certificate you want to attach to the endpoint.
+
** *Use StorageGRID S3 and Swift certificate*
** *Upload certificate*
** *Generate certificate*



. If you selected *Upload Certificate*:
+
image::../media/load_balancer_endpoint_upload_cert.png[Upload Cert]
+
.. Browse for the server certificate and the certificate private key.
+
To enable S3 clients to connect using an S3 API endpoint domain name, use a multi-domain or wildcard certificate that matches all domain names that the client might use to connect to the grid. For example, the server certificate might use the domain name `*._example_.com`.
+
xref:configuring_s3_api_endpoint_domain_names.adoc[Configuring S3 API endpoint domain names]

 .. Optionally browse for a CA bundle.
 .. Select *Save*.
+
The PEM-encoded certificate data for the endpoint appears.

. If you want to generate a certificate, select *Generate Certificate*.
+
image::../media/load_balancer_endpoint_generate_cert.png[Generate Cert]

 .. Enter a domain name or an IP address.
+
You can use wildcards to represent the fully qualified domain names of all Admin Nodes and Gateway Nodes running the Load Balancer service. For example, `*.sgws.foo.com` uses the * wildcard to represent `gn1.sgws.foo.com` and `gn2.sgws.foo.com`.
+
xref:configuring_s3_api_endpoint_domain_names.adoc[Configuring S3 API endpoint domain names]

 .. Select image:../media/icon_plus_sign_black_on_white.gif[Plus Sign] to add any other domain names or IP addresses.
+
If you are using high availability (HA) groups, add the domain names and IP addresses of the HA virtual IPs.

 .. Optionally, enter an X.509 subject, also referred to as the Distinguished Name (DN), to identify who owns the certificate.
 .. Optionally, select the number of days the certificate is valid. The default is 730 days.
 .. Select *Generate*.
+
The certificate metadata and the PEM-encoded certificate data for the endpoint appear.

. Select *Create*.
+
The endpoint is created. The table on the Load balancer endpoints page lists the endpoint's name, port, and network protocol.

== Editing load balancer endpoints


For an unsecured (HTTP) endpoint, you can change the endpoint service type between S3 and Swift. For a secured (HTTPS) endpoint, you can edit the endpoint service type and view or change the security certificate.

.Steps

. Select *CONFIGURATION > Network > Load balancer endpoints*.
. Select the radio button for the endpoint you want to edit.
. Click *Actions > Edit*.
. Make the desired changes to the endpoint.
+
For an unsecured (HTTP) endpoint, you can:
+
 * Change the endpoint service type between S3 and Swift.
 * Change the endpoint binding mode.

+
For a secured (HTTPS) endpoint, you can:

 * Change the endpoint service type between S3 and Swift.
 * Change the endpoint binding mode.
 * View the security certificate.
 * Upload or generate a new security certificate when the current certificate is expired or about to expire.
* Display information about the default StorageGRID server certificate or a CA signed certificate that was uploaded.

+
NOTE: To change the protocol for an existing endpoint, for example from HTTP to HTTPS, you must create a new endpoint. Follow the instructions for creating load balancer endpoints, and select the desired protocol.

. Select *Save*.


== Removing load balancer endpoints

You can remove a load balancer endpoint that you no longer need.

.Steps

. Select *CONFIGURATION* > *Network* > *Load balancer endpoints*.
. Select the radio button for the endpoint you want to remove.
. Select *Actions* > *Remove*.
. Select *OK* to remove the endpoint.
